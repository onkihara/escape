{"version":3,"file":"mysql-5a8abac0.js","sources":["../../../.svelte-kit/adapter-node/chunks/mysql.js"],"sourcesContent":["import * as mysql from \"mysql\";\nconst BLIKK_ESCAPE_SECRET = \"afafeifÃ¶89452--fffieruqeru349\";\nconst BLIKK_ESCAPE_DBHOST = \"192.168.10.10\";\nconst BLIKK_ESCAPE_DBUSER = \"root\";\nconst BLIKK_ESCAPE_DBPASS = \"test%test\";\nconst BLIKK_ESCAPE_DBNAME = \"escape\";\nconst db = {\n  connect,\n  close,\n  getPlayer,\n  getHouseByHash,\n  getPlayerKeysByHouse,\n  setRank,\n  runQuery\n};\nfunction getPlayer(access_key) {\n  return new Promise((resolve, reject) => {\n    const connection = connect();\n    const houses = { houses: [], player: {} };\n    connection.query(\"SELECT * FROM `players`, `houses` WHERE `key` LIKE ? AND `house_id` = `houses`.`id`\", [access_key], (error, results, fields) => {\n      if (error)\n        reject(null);\n      houses.player.key = access_key;\n      houses.player.is_root = false;\n      houses.player.rank = results[0] ? results[0].rank : 0;\n      for (let i = 0; i < results.length; i++) {\n        houses.houses[i] = {\n          role: results[i].role,\n          house_id: results[i].house_id,\n          house_name: results[i].name,\n          hash: results[i].hash,\n          key: results[i].key\n        };\n        if (results[i].role === \"root\") {\n          houses.player.is_root = true;\n        }\n      }\n      resolve(houses);\n    });\n    close(connection);\n  });\n}\nasync function getHouseByHash(hash) {\n  return new Promise((resolve, reject) => {\n    const connection = connect();\n    connection.query(\"SELECT * FROM `houses` WHERE `hash` LIKE ?\", [hash], (error, results, fields) => {\n      if (error) {\n        reject(error);\n      } else {\n        resolve(results);\n      }\n    });\n    close(connection);\n  });\n}\nfunction getPlayerKeysByHouse(house_id) {\n  return new Promise((resolve, reject) => {\n    const connection = connect();\n    let keys = [];\n    connection.query(\"SELECT * FROM `players` WHERE `house_id` LIKE ?\", [house_id], (error, results, fields) => {\n      if (error) {\n        reject(error);\n      } else {\n        for (let i = 0; i < results.length; i++) {\n          keys.push(results[i].key);\n        }\n        resolve(keys);\n      }\n    });\n    close(connection);\n  });\n}\nfunction setRank(house_id, player_key, new_rank) {\n  const date = (/* @__PURE__ */ new Date()).toISOString().slice(0, 19).replace(\"T\", \" \");\n  return new Promise((resolve, reject) => {\n    const connection = connect();\n    connection.query(\"UPDATE `players` SET `rank` = ?, `updated_at` = ? WHERE `house_id` LIKE ? AND `key` LIKE ?\", [new_rank, date, house_id, player_key], (error, results, fields) => {\n      if (error) {\n        reject(error);\n      } else {\n        resolve(new_rank);\n      }\n    });\n    close(connection);\n  });\n}\nfunction runQuery(query, values) {\n  return new Promise((resolve, reject) => {\n    const connection = connect();\n    connection.query(query, values, (err, results) => {\n      if (err) {\n        reject(err);\n      } else {\n        resolve(results);\n      }\n    });\n    close(connection);\n  });\n}\nfunction connect() {\n  const connpars = {\n    host: BLIKK_ESCAPE_DBHOST,\n    user: BLIKK_ESCAPE_DBUSER,\n    password: BLIKK_ESCAPE_DBPASS,\n    database: BLIKK_ESCAPE_DBNAME\n  };\n  return mysql.createConnection(connpars);\n}\nfunction close(connection) {\n  connection.end();\n}\nexport {\n  BLIKK_ESCAPE_SECRET as B,\n  db as d\n};\n"],"names":[],"mappings":";;AACK,MAAC,mBAAmB,GAAG,gCAAgC;AAC5D,MAAM,mBAAmB,GAAG,eAAe,CAAC;AAC5C,MAAM,mBAAmB,GAAG,MAAM,CAAC;AACnC,MAAM,mBAAmB,GAAG,WAAW,CAAC;AACxC,MAAM,mBAAmB,GAAG,QAAQ,CAAC;AAChC,MAAC,EAAE,GAAG;AACX,EAAE,OAAO;AACT,EAAE,KAAK;AACP,EAAE,SAAS;AACX,EAAE,cAAc;AAChB,EAAE,oBAAoB;AACtB,EAAE,OAAO;AACT,EAAE,QAAQ;AACV,EAAE;AACF,SAAS,SAAS,CAAC,UAAU,EAAE;AAC/B,EAAE,OAAO,IAAI,OAAO,CAAC,CAAC,OAAO,EAAE,MAAM,KAAK;AAC1C,IAAI,MAAM,UAAU,GAAG,OAAO,EAAE,CAAC;AACjC,IAAI,MAAM,MAAM,GAAG,EAAE,MAAM,EAAE,EAAE,EAAE,MAAM,EAAE,EAAE,EAAE,CAAC;AAC9C,IAAI,UAAU,CAAC,KAAK,CAAC,qFAAqF,EAAE,CAAC,UAAU,CAAC,EAAE,CAAC,KAAK,EAAE,OAAO,EAAE,MAAM,KAAK;AACtJ,MAAM,IAAI,KAAK;AACf,QAAQ,MAAM,CAAC,IAAI,CAAC,CAAC;AACrB,MAAM,MAAM,CAAC,MAAM,CAAC,GAAG,GAAG,UAAU,CAAC;AACrC,MAAM,MAAM,CAAC,MAAM,CAAC,OAAO,GAAG,KAAK,CAAC;AACpC,MAAM,MAAM,CAAC,MAAM,CAAC,IAAI,GAAG,OAAO,CAAC,CAAC,CAAC,GAAG,OAAO,CAAC,CAAC,CAAC,CAAC,IAAI,GAAG,CAAC,CAAC;AAC5D,MAAM,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,OAAO,CAAC,MAAM,EAAE,CAAC,EAAE,EAAE;AAC/C,QAAQ,MAAM,CAAC,MAAM,CAAC,CAAC,CAAC,GAAG;AAC3B,UAAU,IAAI,EAAE,OAAO,CAAC,CAAC,CAAC,CAAC,IAAI;AAC/B,UAAU,QAAQ,EAAE,OAAO,CAAC,CAAC,CAAC,CAAC,QAAQ;AACvC,UAAU,UAAU,EAAE,OAAO,CAAC,CAAC,CAAC,CAAC,IAAI;AACrC,UAAU,IAAI,EAAE,OAAO,CAAC,CAAC,CAAC,CAAC,IAAI;AAC/B,UAAU,GAAG,EAAE,OAAO,CAAC,CAAC,CAAC,CAAC,GAAG;AAC7B,SAAS,CAAC;AACV,QAAQ,IAAI,OAAO,CAAC,CAAC,CAAC,CAAC,IAAI,KAAK,MAAM,EAAE;AACxC,UAAU,MAAM,CAAC,MAAM,CAAC,OAAO,GAAG,IAAI,CAAC;AACvC,SAAS;AACT,OAAO;AACP,MAAM,OAAO,CAAC,MAAM,CAAC,CAAC;AACtB,KAAK,CAAC,CAAC;AACP,IAAI,KAAK,CAAC,UAAU,CAAC,CAAC;AACtB,GAAG,CAAC,CAAC;AACL,CAAC;AACD,eAAe,cAAc,CAAC,IAAI,EAAE;AACpC,EAAE,OAAO,IAAI,OAAO,CAAC,CAAC,OAAO,EAAE,MAAM,KAAK;AAC1C,IAAI,MAAM,UAAU,GAAG,OAAO,EAAE,CAAC;AACjC,IAAI,UAAU,CAAC,KAAK,CAAC,4CAA4C,EAAE,CAAC,IAAI,CAAC,EAAE,CAAC,KAAK,EAAE,OAAO,EAAE,MAAM,KAAK;AACvG,MAAM,IAAI,KAAK,EAAE;AACjB,QAAQ,MAAM,CAAC,KAAK,CAAC,CAAC;AACtB,OAAO,MAAM;AACb,QAAQ,OAAO,CAAC,OAAO,CAAC,CAAC;AACzB,OAAO;AACP,KAAK,CAAC,CAAC;AACP,IAAI,KAAK,CAAC,UAAU,CAAC,CAAC;AACtB,GAAG,CAAC,CAAC;AACL,CAAC;AACD,SAAS,oBAAoB,CAAC,QAAQ,EAAE;AACxC,EAAE,OAAO,IAAI,OAAO,CAAC,CAAC,OAAO,EAAE,MAAM,KAAK;AAC1C,IAAI,MAAM,UAAU,GAAG,OAAO,EAAE,CAAC;AACjC,IAAI,IAAI,IAAI,GAAG,EAAE,CAAC;AAClB,IAAI,UAAU,CAAC,KAAK,CAAC,iDAAiD,EAAE,CAAC,QAAQ,CAAC,EAAE,CAAC,KAAK,EAAE,OAAO,EAAE,MAAM,KAAK;AAChH,MAAM,IAAI,KAAK,EAAE;AACjB,QAAQ,MAAM,CAAC,KAAK,CAAC,CAAC;AACtB,OAAO,MAAM;AACb,QAAQ,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,OAAO,CAAC,MAAM,EAAE,CAAC,EAAE,EAAE;AACjD,UAAU,IAAI,CAAC,IAAI,CAAC,OAAO,CAAC,CAAC,CAAC,CAAC,GAAG,CAAC,CAAC;AACpC,SAAS;AACT,QAAQ,OAAO,CAAC,IAAI,CAAC,CAAC;AACtB,OAAO;AACP,KAAK,CAAC,CAAC;AACP,IAAI,KAAK,CAAC,UAAU,CAAC,CAAC;AACtB,GAAG,CAAC,CAAC;AACL,CAAC;AACD,SAAS,OAAO,CAAC,QAAQ,EAAE,UAAU,EAAE,QAAQ,EAAE;AACjD,EAAE,MAAM,IAAI,GAAG,iBAAiB,IAAI,IAAI,EAAE,EAAE,WAAW,EAAE,CAAC,KAAK,CAAC,CAAC,EAAE,EAAE,CAAC,CAAC,OAAO,CAAC,GAAG,EAAE,GAAG,CAAC,CAAC;AACzF,EAAE,OAAO,IAAI,OAAO,CAAC,CAAC,OAAO,EAAE,MAAM,KAAK;AAC1C,IAAI,MAAM,UAAU,GAAG,OAAO,EAAE,CAAC;AACjC,IAAI,UAAU,CAAC,KAAK,CAAC,4FAA4F,EAAE,CAAC,QAAQ,EAAE,IAAI,EAAE,QAAQ,EAAE,UAAU,CAAC,EAAE,CAAC,KAAK,EAAE,OAAO,EAAE,MAAM,KAAK;AACvL,MAAM,IAAI,KAAK,EAAE;AACjB,QAAQ,MAAM,CAAC,KAAK,CAAC,CAAC;AACtB,OAAO,MAAM;AACb,QAAQ,OAAO,CAAC,QAAQ,CAAC,CAAC;AAC1B,OAAO;AACP,KAAK,CAAC,CAAC;AACP,IAAI,KAAK,CAAC,UAAU,CAAC,CAAC;AACtB,GAAG,CAAC,CAAC;AACL,CAAC;AACD,SAAS,QAAQ,CAAC,KAAK,EAAE,MAAM,EAAE;AACjC,EAAE,OAAO,IAAI,OAAO,CAAC,CAAC,OAAO,EAAE,MAAM,KAAK;AAC1C,IAAI,MAAM,UAAU,GAAG,OAAO,EAAE,CAAC;AACjC,IAAI,UAAU,CAAC,KAAK,CAAC,KAAK,EAAE,MAAM,EAAE,CAAC,GAAG,EAAE,OAAO,KAAK;AACtD,MAAM,IAAI,GAAG,EAAE;AACf,QAAQ,MAAM,CAAC,GAAG,CAAC,CAAC;AACpB,OAAO,MAAM;AACb,QAAQ,OAAO,CAAC,OAAO,CAAC,CAAC;AACzB,OAAO;AACP,KAAK,CAAC,CAAC;AACP,IAAI,KAAK,CAAC,UAAU,CAAC,CAAC;AACtB,GAAG,CAAC,CAAC;AACL,CAAC;AACD,SAAS,OAAO,GAAG;AACnB,EAAE,MAAM,QAAQ,GAAG;AACnB,IAAI,IAAI,EAAE,mBAAmB;AAC7B,IAAI,IAAI,EAAE,mBAAmB;AAC7B,IAAI,QAAQ,EAAE,mBAAmB;AACjC,IAAI,QAAQ,EAAE,mBAAmB;AACjC,GAAG,CAAC;AACJ,EAAE,OAAO,KAAK,CAAC,gBAAgB,CAAC,QAAQ,CAAC,CAAC;AAC1C,CAAC;AACD,SAAS,KAAK,CAAC,UAAU,EAAE;AAC3B,EAAE,UAAU,CAAC,GAAG,EAAE,CAAC;AACnB;;;;"}